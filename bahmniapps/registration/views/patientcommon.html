<div ng-controller="PatientCommonController">
    <div class="box-container box-container-patient-info patient-common-info-container">
        <section>
            <article class="form-field patient-name-wrapper" ng-if="::patientConfiguration.local()['showNameField']">
                <div class="field-attribute">
                    <label for="patientName">{{::getTranslatedPatientControls(patientConfiguration.local()['labelForNameField'])}}</label>
                </div>
                
                
                <!--div class="field-value" id="patientNameLocal">
                    <span ng-repeat="nameField in patientNameDisplayOrder">
                        <This area below is where we place the actual fields that contain each of the name slots>
                        <input type="text" id="givenNameLocal" ng-model="patient.givenNameLocal" pattern-validate placeholder="{{::getTranslatedPatientControls(patientConfiguration.local()['placeholderForGivenName'])}}" focus-me="true" ng-if="nameField === 'firstName'">
                        
                        <input ng-show="::showMiddleName" type="text" id="middleNameLocal" ng-model="patient.middleNameLocal" pattern-validate placeholder="{{::getTranslatedPatientControls(patientConfiguration.local()['placeholderForMiddleName'])}}" ng-if="nameField === 'middleName'">
                        
                        <input type="text" ng-show="::showLastName" id="familyNameLocal" ng-model="patient.familyNameLocal" pattern-validate placeholder="{{::getTranslatedPatientControls(patientConfiguration.local()['placeholderForFamilyName'])}}" ng-if="nameField === 'lastName'">
                        <input type="text" ng-show="::showSurname" id="surnameLocal" ng-model="patient.surnameLocal" pattern-validate placeholder="{{::getTranslatedPatientControls(patientConfiguration.local()['placeholderForSurname'])}}" ng-if="nameField === 'surname'">
                    </span>
                </div-->
            </article>
            
            
            <article class="form-field patient-name-wrapper">
                <div class="field-attribute">
                    <label for="patientName">{{ ::'REGISTRATION_LABEL_PATIENT_NAME' | translate}}<span class="asterick">*</span></label>
                </div>
                <div class="field-value patient-name" id="patientName">
                <span ng-repeat="nameField in patientNameDisplayOrder">
                    <span data-ng-switch="::isAutoComplete('givenName')" ng-if="::patientConfiguration.local()['showNameField'] && nameField === 'firstName'">
                          <input data-ng-switch-when="true" type="text" id="givenName" ng-model="$parent.patient.givenName" non-blank pattern-validate my-autocomplete source="getAutoCompleteList" response-map="getDataResults" data-item-type="personName" placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_FIRSTNAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_NAME' | translate}}">
                          <input data-ng-switch-default type="text" id="givenName" ng-model="patient.givenName" non-blank pattern-validate placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_FIRSTNAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_NAME' | translate}}">
                    </span>
                    <span data-ng-switch="::isAutoComplete('givenName')" ng-if="::!patientConfiguration.local()['showNameField'] && nameField === 'firstName'">
                      <input data-ng-switch-when="true" type="text" id="givenName" ng-model="$parent.patient.givenName" non-blank pattern-validate my-autocomplete source="getAutoCompleteList" response-map="getDataResults" data-item-type="personName" placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_FIRSTNAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_NAME' | translate}}" focus-me="true">
                      <input data-ng-switch-default type="text" id="givenName" ng-model="patient.givenName" non-blank pattern-validate placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_FIRSTNAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_NAME' | translate}}" focus-me="true">
                    </span>
                    <span ng-show="::showMiddleName" data-ng-switch="::isAutoComplete('middleName')" ng-if="nameField === 'middleName'">
                      <input data-ng-switch-when="true" type="text" id="middleName" ng-model="$parent.patient.middleName" pattern-validate my-autocomplete source="getAutoCompleteList" response-map="getDataResults" data-item-type="personName" placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_MIDDLE_NAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_MIDDLE_NAME' | translate}}">
                      <input data-ng-switch-default type="text" id="middleName" ng-model="patient.middleName" pattern-validate placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_MIDDLE_NAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_MIDDLE_NAME' | translate}}">
                    </span>
                    
                    <span ng-show="::showLastName" data-ng-switch="::isAutoComplete('familyName')" ng-if="nameField === 'lastName'">
                      <input data-ng-switch-when="true" type="text" id="familyName" ng-model="$parent.patient.familyName" pattern-validate my-autocomplete source="getAutoCompleteList" response-map="getDataResults" data-item-type="personName" placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_LAST_NAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_LAST_NAME' | translate}}" ng-required="::isLastNameMandatory">
                      <input data-ng-switch-default type="text" id="familyName" ng-model="patient.familyName" pattern-validate placeholder="{{ ::'REGISTRATION_LABEL_PATIENT_LAST_NAME' | translate}}" title="{{::'REGISTRATION_LABEL_PATIENT_ENTER_LAST_NAME' | translate}}" ng-required="::isLastNameMandatory">
                    </span>
                </span>
            </article>
            
            
        </section>
        <!--section class="form-field form-field-admission-type">
            <article class="form-field">
                <div class="field-attribute">
                    <label for="admissionType">{{ :: 'REGISTRATION_LABEL_ADMISSION_TYPE' | translate}} <span class="asterick">*</span></label>
                </div>
                
                 <div class="field-value">
                    <select id="admisstionType" ng-model="patient.admissionType" required="required" title="{{ 'REGISTRATION_LABEL_ADMISSION_TYPE'|translate }}" ng-options="name for type in admissionType">
                        <option value="">{{ ::'REGISTRATION_LABEL_ADMISSION_TYPE' | translate}}</option>
                    </select>
                </div>
                
            </article>
        </section-->
        <!--section class="form-field form-field-case-file">
            <article class="form-field">
                <div class="field-attribute">
                    <label for="caseFile">{{ :: 'REGISTRATION_LABEL_CASE_FILE' | translate}} <span class="asterick">*</span></label>
                </div>
                
                 <div class="field-value">
                    <select id="admisstionType" ng-model="patient.idNum" required="required" title="{{ 'REGISTRATION_LABEL_ADMISSION_TYPE'|translate }}" ng-options="name for type in idNum">
                        <option value="">{{ ::'REGISTRATION_LABEL_ADMISSION_TYPE' | translate}}</option>
                    </select>
                </div>
                
            </article>
        </section-->
        <section class="form-field form-field-gender">
            <article class="form-field">
                <div class="field-attribute">
                    <label for="gender">{{ ::'REGISTRATION_LABEL_GENDER' | translate}} <span class="asterick">*</span></label>
                </div>

                <div class="field-value">
                    <select id="gender" ng-model="patient.gender" required="required" title="{{ 'REGISTRATION_LABEL_SELECT_GENDER'|translate }}" ng-options="genderMap[genderCode] for genderCode in genderCodes track by genderCode" ng-change="handleUpdate('gender')">
                        <option value="">{{ ::'REGISTRATION_LABEL_SELECT_GENDER' | translate}}</option>
                    </select>
                    <!--<div class="selectGender">
                        <ul>
                            <li><a href="javascript:void(0)">Male</a></li>
                            <li><a href="javascript:void(0)">Female</a></li>
                            <li><a href="javascript:void(0)">Other</a></li>
                        </ul>
                    </div>-->
                </div>
            </article>
        </section>
        <section class="age-wrapper">
            <div ng-if="::!dobMandatory">
                <ng-include src="'views/age.html'"></ng-include>
                <ng-include src="'views/dob.html'"></ng-include>
            </div>
            <div ng-if="::dobMandatory">
                <ng-include src="'views/dob.html'"></ng-include>
                <ng-include src="'views/age.html'"></ng-include>
            </div>
        </section>
        <legend class="registraion_legend" ng-if="patient.extraIdentifiers.length>0">
            <span class="mylegend">{{ ::'REGISTRATION_ADDTIONAL_IDENTIFIERS' | translate}}</span>
        </legend>

        <section>
            <edit patient flow>
            <section>
                <div ng-if="patient.uuid != undefined">
                    <article ng-repeat="identifier in patient.extraIdentifiers" class="form-field existing-patient">
                        <div class="field-attribute">
                            <label class="control-label" for="patientID">{{:: getTranslatedPatientIdentifier(identifier.identifierType.name)}}
                                <span ng-show=":: identifier.identifierType.required && !identifier.hasIdentifierSources()" class="asterick">*</span>
                            </label>
                        </div>
                        <div class="field-value">
                            <input type="text" ng-model="identifier.identifier" disabled="disabled" ng-if="identifier.hasIdentifierSources()"/>

                            <input type="text" id="registrationNumber" ng-model="identifier.registrationNumber" ng-if="!identifier.hasIdentifierSources()" non-blank="identifier.identifierType.required && !identifier.hasIdentifierSources()" pattern-validate ng-change="identifier.generate()" ng-disabled="readOnlyExtraIdentifiers.indexOf(identifier.identifierType.name)>-1">
                        </div>
                    </article>
                </div>
                <div ng-if="patient.uuid == undefined">
                    <article ng-repeat="identifier in patient.extraIdentifiers" class="form-field existing-patient">
                        <div class="field-attribute">
                            <label class="control-label" for="patientID">{{:: getTranslatedPatientControls(identifier.identifierType.name)}}
                                <span ng-show="::identifier.identifierType.required && !identifier.hasIdentifierSources()" class="asterick">*</span>
                            </label>
                        </div>
                        <div ng-show="::(identifier.hasIdentifierSources() && !identifier.hasIdentifierSourceWithEmptyPrefix())" class="field-value" id="patientID">
                            <select id="identifierPrefix" ng-model="identifier.selectedIdentifierSource" ng-options="identifierSource.prefix for identifierSource in ::identifier.identifierType.identifierSources" ng-change="patient.generateIdentifier(identifier)" required>
                            </select>
                        </div>
                        <div class="field-value" ng-if="!identifier.hasIdentifierSources()">
                            <input type="text" id="registrationNumber" ng-model="identifier.registrationNumber" non-blank="identifier.isIdentifierRequired()" pattern-validate ng-change="identifier.generate()" focus-on="identifier.hasOldIdentifier" ng-show="identifier.hasOldIdentifier || !identifier.hasIdentifierSources()" ng-disabled="readOnlyExtraIdentifiers.indexOf(identifier.identifierType.name)>-1">
                        </div>

                        <div class="field-value field-value-has-identifier" ng-show="::identifier.hasIdentifierSources()">
                            <input type="text" id="registrationNumber" ng-model="identifier.registrationNumber" non-blank="identifier.isIdentifierRequired()" pattern-validate ng-change="identifier.generate()" focus-on="identifier.hasOldIdentifier" ng-show="identifier.hasOldIdentifier || !identifier.hasIdentifierSources()" ng-disabled="readOnlyExtraIdentifiers.indexOf(identifier.identifierType.name)>-1">

                            <div class="fl">
                                <div class="field-attribute hasOldIdentifier-field-attribute">
                                    <label for="hasOldIdentifier" ng-show="::showEnterID" class="control-label">{{::'REGISTRATION_LABEL_ENTER_ID' |
                                        translate}}</label>
                                </div>
                                <div class="field-value">
                                    <input class="input-label-inline" ng-show="::showEnterID" type="checkbox" id="hasOldIdentifier" ng-model="identifier.hasOldIdentifier" ng-change="identifier.clearRegistrationNumber()">
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            </section>
        </section>

        <legend class="registraion_legend">
            <span class="mylegend">{{ ::'REGISTRATION_LABEL_OTHER_INFO' | translate}}</span>
            
            <section class="form-field-inline">
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="cellphone">{{ ::'REGISTRATION_LABEL_CELL' | translate}}</label>
                    </div>
    
                    <div class="field-value">
                        <input id="cellphone" type="text" ng-model="patient.cellphone" title="{{ 'REGISTRATION_LABEL_CELL'|translate }}" ng-change="handleUpdate()">
                        </input>
                    </div>
                </article>
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="homephone">{{ ::'REGISTRATION_LABEL_HOME' | translate}}</label>
                    </div>  
                    <div class="field-value">
                        <input id="homephone" type="text" ng-model="patient.homephone" title="{{ 'REGISTRATION_LABEL_HOME'|translate }}" ng-change="handleUpdate()"></input>
                    </div>                 
                </article>
            </section>


            <section class="form-field-inline">
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="email">{{ ::'REGISTRATION_LABEL_EMAIL' | translate}}</label>
                    </div>
                    <div class="field-value">
                        <input id="email" type="text" ng-model="patient.email" title="{{ 'REGISTRATION_LABEL_EMAIL'|translate }}" ng-change="handleUpdate()"></input>
                    </div>
                </article>
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="Facebook">{{ ::'REGISTRATION_LABEL_FACEBK' | translate}}</label>
                    </div>
                    <div class="field-value">
                        <input id="Facebook" type="text" ng-model="patient.facebook" title="{{ 'REGISTRATION_LABEL_FACEBK'|translate }}" ng-change="handleUpdate()"></input>
                    </div>
                </article>
            </section>

            <section class="form-field-inline">
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="Instagram">{{ ::'REGISTRATION_LABEL_INSTGRM' | translate}}</label>
                    </div>
                    <div class="field-value">
                        <input id="Instagram" type="text" ng-model="patient.instagram" title="{{ 'REGISTRATION_LABEL_INSTAGRAM'|translate }}" ng-change="handleUpdate()"></input>
                    </div>
                </article>
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="education">{{ ::'REGISTRATION_LABEL_EDUCATION' | translate}}</label>
                    </div>
                    <!--concept-dropdown ng-model="patient.education" ng-change="handleUpdate"></concept-dropdown-->
                </article>
            </section>

            <section class="form-field-inline">
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="occupation">{{ ::'REGISTRATION_LABEL_OCCUPATION' | translate}}</label>
                    </div>
                    <div class="field-value">
                        <select id="occupation" ng-model="patient.occupation" title="{{ 'REGISTRATION_LABEL_OCCUPATION'|translate }}" ng-change="handleUpdate()"></input>
                    </div>
                </article>
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="distance">{{ ::'REGISTRATION_LABEL_DISTANCE' | translate}}</label>
                    </div>
                    <div class="field-value">
                        <input id="distance" type="text" ng-model="patient.distance" title="{{ 'REGISTRATION_LABEL_DISTANCE'|translate }}" ng-change="handleUpdate()"></input>
                    </div>
                </article>
            </section>

            <section class="form-field-inline">
                <article class="form-field">
                    <div class="field-attribute">
                        <label for="acres">{{ ::'REGISTRATION_LABEL_ACRES' | translate}}</label>
                    </div>
                    <div class="field-value">
                        <input id="acres" type="text" ng-model="patient.acres" title="{{ 'REGISTRATION_LABEL_ACRES'|translate }}" ng-change="handleUpdate()"></input>
                    </div>
                </article>
            </section>
        </section>

        <!--section class="form-field form-field-admission-type">
            <article class="form-field">
                <div class="field-attribute">
                    <label for="relationship">{{ :: 'REGISTRATION_TITLE_RELATIONSHIPS' | translate}} <span class="asterick">*</span></label>
                </div>
            
                <div class="field-value">
                    <select id="relationship" ng-model="$parent.Relationship" title="{{ 'REGISTRATION_TITLE_RELATIONSHIPS'|translate }}" ng-options="name for relationship in RelationshipType">
                        <option value="">{{ ::'REGISTRATION_TITLE_RELATIONSHIPS' | translate}}</option>
                    </select>
                </div>
            
            </article>
        </section>
        
        <section class="form-field-inline clearfix" ng-repeat="attributeRow in ::patientConfiguration.customAttributeRows()">
            <article class="form-field" ng-repeat="attribute in ::attributeRow" ng-class="::{'right-form-field' : $index%2 != 0}">
                <attribute-types target-model="patient" attribute="::attribute" field-validation="::fieldValidation" is-auto-complete="isAutoComplete" get-auto-complete-list="getAutoCompleteList" get-data-results="getDataResults" is-read-only="isReadOnly" handle-update="handleUpdate"></attribute-types>
            </article>
        </section-->
        <legend class="registraion_legend" ng-if="::addressLevels.length>0">
            <span class="mylegend"> {{ ::'REGISTRATION_LABEL_ADDRESS_INFO' | translate}}</span>
        </legend>
    
        <section address-fields data-address-levels="::addressLevels" data-address="patient.address" field-validation="::fieldValidation" strict-autocomplete-from-level="::addressHierarchyConfigs.strictAutocompleteFromLevel" ng-if="::!addressHierarchyConfigs.showAddressFieldsTopDown"></section>
    
        <section top-down-address-fields data-address-levels="::addressLevels" data-address="patient.address" field-validation="::fieldValidation" ng-if="::addressHierarchyConfigs.showAddressFieldsTopDown" strict-autocomplete-from-level="::addressHierarchyConfigs.strictAutocompleteFromLevel"></section>    
    </div>
    
    <!--This is the area to edit additional information          v Person Attributes we place in app.json-->
    <div ng-repeat="section in ::patientConfiguration.getOrderedPatientAttributesSections()">
        <div ng-if="section.canShow">
            <div class="box-container form" ng-if="::(section.attributes.length > 0 && section.title)">
                <legend class="additional-attribute" toggle="section.expand">
              <span>
                  <i class="fa fa-caret-right"></i>
                  <i class="fa fa-caret-down"></i>
                  <strong>
                      <a ng-if="::section.translationKey" href accesskey="{{::section.shortcutKey | translate}}" ng-bind-html="::section.translationKey | translate">
                      </a>
                      <a ng-if="::(section.title && !section.translationKey)" href>{{::'REGISTRATION_TITLE_RELATIONSHIPS' | translate}}</a>
                  </strong>
              </span>
                </legend>
                <section class="form-field-inline clearfix" ng-show="section.expand">
                    <article class="form-field" ng-repeat="attribute in ::section.attributes" ng-class="::{'right-form-field' : $index%2 != 0}">
                        <attribute-types target-model="$scope.responsibleSigning" attribute="::attribute" field-validation="::fieldValidation" is-auto-complete="isAutoComplete" get-auto-complete-list="getAutoCompleteList" get-data-results="getDataResults" is-read-only="isReadOnly" handle-update="handleUpdate"></attribute-types>
                    </article>
                </section>
            </div>
        </div>
    </div>
    
    <div ng-repeat="section in ::patientConfiguration.getOrderedPatientAttributesSections()" class="otherInfoContainer">
        <div ng-if="section.canShow">
            <div class="box-container form2" ng-if="::(section.attributes.length > 0 && section.title)">
                <legend class="additional-attribute" toggle="section2.expand">
              <span>
                  <i class="fa fa-caret-right"></i>
                  <i class="fa fa-caret-down"></i>
                  <strong>
                      <a ng-if="::section.translationKey" href accesskey="{{::section.shortcutKey | translate}}" ng-bind-html="::section.translationKey | translate">
                      </a>
                      <a ng-if="::(section.title && !section.translationKey)" href>{{::'REGISTRATION_TITLE_CONTACT_1' | translate}}</a>
                  </strong>
              </span>
                </legend>
                <section class="form-field-inline" ng-show="section2.expand">
                    <article class="form-field" ng-repeat="attribute in ::section.attributes" ng-class="::{'right-form-field' : $index%2 != 0}">
                        <attribute-types target-model="patient.primaryContact" attribute="::attribute" field-validation="::fieldValidation" is-auto-complete="isAutoComplete" get-auto-complete-list="getAutoCompleteList" get-data-results="getDataResults" is-read-only="isReadOnly" handle-update="handleUpdate"></attribute-types>
                    </article>
                </section>
            </div>
        </div>
    </div>

    <div ng-repeat="section in ::patientConfiguration.getOrderedPatientAttributesSections()" class="otherInfoContainer">
        <div ng-if="section.canShow">
            <div class="box-container form2" ng-if="::(section.attributes.length > 0 && section.title)">
                <legend class="additional-attribute" toggle="section3.expand">
              <span>
                  <i class="fa fa-caret-right"></i>
                  <i class="fa fa-caret-down"></i>
                  <strong>
                      <a ng-if="::section.translationKey" href accesskey="{{::section.shortcutKey | translate}}" ng-bind-html="::section.translationKey | translate">
                      </a>
                      <a ng-if="::(section.title && !section.translationKey)" href>{{::'REGISTRATION_TITLE_CONTACT_2' | translate}}</a>
                  </strong>
              </span>
                </legend>
                <section class="form-field-inline clearfix" ng-show="section3.expand">
                    <article class="form-field" ng-repeat="attribute in ::section.attributes" ng-class="::{'right-form-field' : $index%2 != 0}">
                        <attribute-types target-model="$scope.patient.secondaryContact" attribute="::attribute" field-validation="::fieldValidation" is-auto-complete="isAutoComplete" get-auto-complete-list="getAutoCompleteList" get-data-results="getDataResults" is-read-only="isReadOnly" handle-update="handleUpdate"></attribute-types>
                    </article>
                </section>
            </div>
        </div>
    </div>
    <!--div class="box-container">
        <legend class="additional-attribute">
          <span>
              <i class="fa fa-caret-right"></i>
              <i class="fa fa-caret-down"></i>
              <strong><a ng-bind-html="::'REGISTRATION_TITLE_ADDITIONAL_PATIENT' | translate"></a></strong>
          </span>
        </legend>
        
        <section class="form-field-inline">
            <article class="form-field">
                <div class="field-attribute">
                    <label for="contact1">{{ ::'REGISTRATION_LABEL_NAME' | translate}}</label>
                </div>
                <div class="field-value">
                    <input id="contact1" type="text" ng-model="patient.primaryContact.Name" title="{{ 'REGISTRATION_LABEL_NAME'|translate }}" ng-change="handleUpdate()"></input>
                </div>
            </article>
        </section>

    </div-->
</div>
